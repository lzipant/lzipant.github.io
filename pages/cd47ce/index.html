<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringMVC参数接收问题总结 | harrison&#39;s blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="后端技术博客,简洁至上,专注Java学习与总结。Java, Spring, SpringBoot, SpringCloud, MyBatis, Netty, RabbitMQ, Kafka, Dubbo, Linux, Linux Kernel等技术文章。">
    <meta name="keywords" content="后端技术博客">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.db69af13.css" as="style"><link rel="preload" href="/assets/js/app.36e91a11.js" as="script"><link rel="preload" href="/assets/js/2.409e0185.js" as="script"><link rel="preload" href="/assets/js/51.e28308a2.js" as="script"><link rel="prefetch" href="/assets/js/10.1206fbe6.js"><link rel="prefetch" href="/assets/js/11.811b7408.js"><link rel="prefetch" href="/assets/js/12.83e62cf0.js"><link rel="prefetch" href="/assets/js/13.3da6fa14.js"><link rel="prefetch" href="/assets/js/14.be23cced.js"><link rel="prefetch" href="/assets/js/15.5b1701fd.js"><link rel="prefetch" href="/assets/js/16.3d55b70f.js"><link rel="prefetch" href="/assets/js/17.7429b142.js"><link rel="prefetch" href="/assets/js/18.796642e8.js"><link rel="prefetch" href="/assets/js/19.ffb2f3b3.js"><link rel="prefetch" href="/assets/js/20.9b77edb3.js"><link rel="prefetch" href="/assets/js/21.45f0bd1c.js"><link rel="prefetch" href="/assets/js/22.05843092.js"><link rel="prefetch" href="/assets/js/23.99984d12.js"><link rel="prefetch" href="/assets/js/24.6a89fd33.js"><link rel="prefetch" href="/assets/js/25.16160e78.js"><link rel="prefetch" href="/assets/js/26.471a561c.js"><link rel="prefetch" href="/assets/js/27.ff9b36a8.js"><link rel="prefetch" href="/assets/js/28.d235529f.js"><link rel="prefetch" href="/assets/js/29.ac8ca018.js"><link rel="prefetch" href="/assets/js/3.1c6d2763.js"><link rel="prefetch" href="/assets/js/30.96538408.js"><link rel="prefetch" href="/assets/js/31.47118b60.js"><link rel="prefetch" href="/assets/js/32.fb74aca4.js"><link rel="prefetch" href="/assets/js/33.d059016b.js"><link rel="prefetch" href="/assets/js/34.c1f0aff0.js"><link rel="prefetch" href="/assets/js/35.1b63946e.js"><link rel="prefetch" href="/assets/js/36.305c9ab9.js"><link rel="prefetch" href="/assets/js/37.1f8690b8.js"><link rel="prefetch" href="/assets/js/38.6a0faec0.js"><link rel="prefetch" href="/assets/js/39.6a4f34cc.js"><link rel="prefetch" href="/assets/js/4.f0a8c30f.js"><link rel="prefetch" href="/assets/js/40.2d767369.js"><link rel="prefetch" href="/assets/js/41.f6602ec0.js"><link rel="prefetch" href="/assets/js/42.d86dc81f.js"><link rel="prefetch" href="/assets/js/43.3193e48c.js"><link rel="prefetch" href="/assets/js/44.ba2bfbed.js"><link rel="prefetch" href="/assets/js/45.c855ea02.js"><link rel="prefetch" href="/assets/js/46.cc0695f3.js"><link rel="prefetch" href="/assets/js/47.9356ab33.js"><link rel="prefetch" href="/assets/js/48.04ed80cc.js"><link rel="prefetch" href="/assets/js/49.3b625cf2.js"><link rel="prefetch" href="/assets/js/5.e688792f.js"><link rel="prefetch" href="/assets/js/50.45f22e5f.js"><link rel="prefetch" href="/assets/js/52.2d74a9f7.js"><link rel="prefetch" href="/assets/js/53.9ea65ca6.js"><link rel="prefetch" href="/assets/js/54.b92ef08c.js"><link rel="prefetch" href="/assets/js/55.c96f6cd9.js"><link rel="prefetch" href="/assets/js/56.66e76778.js"><link rel="prefetch" href="/assets/js/57.290715f8.js"><link rel="prefetch" href="/assets/js/58.68f33ada.js"><link rel="prefetch" href="/assets/js/59.a0c46087.js"><link rel="prefetch" href="/assets/js/6.feb75664.js"><link rel="prefetch" href="/assets/js/60.942b9285.js"><link rel="prefetch" href="/assets/js/7.3e34b1bc.js"><link rel="prefetch" href="/assets/js/8.e4dd00a2.js"><link rel="prefetch" href="/assets/js/9.74704eea.js">
    <link rel="stylesheet" href="/assets/css/0.styles.db69af13.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/HL-logo.png" alt="harrison's blog" class="logo"> <span class="site-name can-hide">harrison's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><!----> <span class="title" style="display:;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/collections/websites/" class="nav-link">网站</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/HarrisonLee1998/image/avatar.jpg"> <div class="blogger-info"><h3>Harrison Lee</h3> <span>玻璃晴朗，橘子辉煌</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><!----> <span class="title" style="display:;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/collections/websites/" class="nav-link">网站</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Spring全家桶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Spring Framework</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading"><span>AOP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading open"><span>Web</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/f167d9/" class="sidebar-link">注册DispatcherServlet</a></li><li><a href="/pages/668c92/" class="sidebar-link">web.xml配置Spring容器启动</a></li><li><a href="/pages/f2c795/" class="sidebar-link">SpringMVC源码分析之HandlerMapping</a></li><li><a href="/pages/b2649d/" class="sidebar-link">SpringMVC源码分析之HandlerAdapter</a></li><li><a href="/pages/cd47ce/" aria-current="page" class="active sidebar-link">SpringMVC参数接收问题总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/cd47ce/#url中的参数" class="sidebar-link">URL中的参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/cd47ce/#查询参数" class="sidebar-link">查询参数</a></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#路径参数" class="sidebar-link">路径参数</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#表单参数" class="sidebar-link">表单参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/cd47ce/#普通表单参数" class="sidebar-link">普通表单参数</a></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#文件上传" class="sidebar-link">文件上传</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#请求头参数" class="sidebar-link">请求头参数</a></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#cookie值" class="sidebar-link">Cookie值</a></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#其他参数" class="sidebar-link">其他参数</a></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#日期类型处理" class="sidebar-link">日期类型处理</a></li><li class="sidebar-sub-header"><a href="/pages/cd47ce/#参考" class="sidebar-link">参考</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Spring Boot</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><ul class="breadcrumbs" data-v-33863c7e><li data-v-33863c7e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-33863c7e></a></li> <li data-v-33863c7e><a href="/categories/?category=%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6" title="分类" data-v-33863c7e>后端框架</a></li> <li data-v-33863c7e><a href="/categories/?category=Spring%E5%85%A8%E5%AE%B6%E6%A1%B6" title="分类" data-v-33863c7e>Spring全家桶</a></li> <li data-v-33863c7e><a href="/categories/?category=Spring%20Framework" title="分类" data-v-33863c7e>Spring Framework</a></li></ul> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="https://github.com/HarrisonLee1998" target="_blank" title="作者" class="beLink" data-v-33863c7e>Harrison Lee</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2021-01-19</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          SpringMVC参数接收问题总结
        </h1> <!----> <div class="theme-vdoing-content content__default"><p>前端请求参数类型和后端接收方式多种多样，前端传递的参数可能是普通表单数据，JSON格式或者是文件等，而后端关于参数绑定这一块又有很多注解。对于某种类型的数据到底使用哪个注解常常困惑笔者，说到底还是对SpringMVC的参数处理机制不太熟悉。所以，本文就来分析一下SpringMVC中参数的接收和校验问题，但愿不再被此类问题困扰。</p> <p>Http请求的参数可能保存在请求头的URL中，也有可能在请求体中，但并不是所有的请求都有请求体，比如<code>GET</code>，<code>HEAD</code>，<code>DELETE</code> ，<code>OPTIONS</code>一般情况下就没有请求体（具体有没有取决于客户端如何发送请求，然后服务的是否进行解析）。<font color="deeppink">所以在编写handlerMethod时一定要搞清楚请求的方法是什么（有没有请求体），Content-Type（或者是Content-Disposition）是什么</font>。一般使用<code>@RequestMapping</code>的<code>consumes</code>属性可以指定请求的Content-Type应该是什么。</p> <p>在前面分析<a href="https://harrisonlee.net/pages/b2649d/" target="_blank" rel="noopener noreferrer">HandlerAdapter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的文章中，知道请求的所有参数都被放入<code>ModelAndViewContainer</code>内部的<code>ModelMap</code>中。具体的参数解析是由参数解析器来进行的，参数解析器在解析的过程中可能会调用消息转换器，将解析后的参数进一步转换为参数目标类型。</p> <p>现在开发中主要使用以下几种MIME的数据：</p> <ul><li>普通表单对应的Content-Type为application/x-www-form-urlencoded。</li> <li>enctype属性为multipart/form-data的表单通常用于上传文件，其Content-Type表示文件的类型，而Content-Disposition中的值表示当前是for-date。</li> <li>applicaton/json，这种方式是目前使用的最多的。</li></ul> <h2 id="url中的参数"><a href="#url中的参数" class="header-anchor">#</a> URL中的参数</h2> <h3 id="查询参数"><a href="#查询参数" class="header-anchor">#</a> 查询参数</h3> <p>下面是一个http请求的URL：</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header-name keyword">http:</span>//127.0.0.1:8080/ssm/user1?username=harrison&amp;age=23
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第一种方式可以使用<code>@RequestParam</code>，但是注意handlerMethod中的参数名必须和URL中的参数名对应，如果不对应则需要指定<code>@RequestParam</code>的value（或name）属性的值对应参数名。对于<code>@RequestParam</code>，SpringMVC使用<code>RequestParamMethodArgumentResolver</code>这个解析器进行参数解析。如果不想写多个参数，可以把这些都放入map中，如果使用map的话，使用的解析器是<code>RequestParamMapMethodArgumentResolver</code>类型的。</p> <p>第二种方式可以使用对象接收，<strong>不用加任何注解</strong>。但是请注意，对象的属性名称要和查询参数名对应。</p> <p>更多信息请参考下文分析普通表单参数那一节内容。</p> <h3 id="路径参数"><a href="#路径参数" class="header-anchor">#</a> 路径参数</h3> <p>URL路径参数是基于URL模板获取到的参数，例如<code>/user/{id}</code>中<code>{id}</code>是参数占位符。可以使用<code>@PathVariable</code>根据参数name（或者是注解的配置值）从URL中取出占位符所对应的参数，对应的参数处理器为<code>PathVariableMethodArgumentResolver</code>。另外，占位符中还可以使用正则表达式进行请求URL匹配。</p> <p>另外一个与路径参数有关的注解是<code>@MatrixVariable</code>，但很少使用，所以这里就不分析了。</p> <h2 id="表单参数"><a href="#表单参数" class="header-anchor">#</a> 表单参数</h2> <h3 id="普通表单参数"><a href="#普通表单参数" class="header-anchor">#</a> 普通表单参数</h3> <p>对于普通表单参数，其Content-Type一般为application/x-www-form-urlencoded，表示也会进行URL编码，对于不具有请求体的请求方式，如GET，浏览器会将其加入到URL中，对于其他存在请求体的数据会放入请求体中。<strong>当Conetent-Type为这种类型且请求方法为POST时</strong>，Servlet容器会在该请求第一次调用<code>getParameterMap()</code>时把请求体中所有URL编码的参数和URL中的查询参数一并放入某个map中，关于这一点，Servlet规范（本文参考的版本为4.0）中3.1小节（Http Protocol Parameters）有说明。</p> <p>上面也说到<code>@RequestParam</code>注解对应的解析器是<code>RequestParamMethodArgumentResolver</code>和<code>RequestParamMapMethodArgumentResolver</code>，前者通过request从上述的map中获取对应参数名的参数值，后者直接获取整个map，这也是为什么<code>@RequestParam</code>可以获取参数到URL编码参数的原因。</p> <p>::: waning</p> <p>经过上述分析，可以明白<code>@RequestParam</code>不是只能获取请求头中的参数的，也能获取请求体中的参数，只要请求方法是POST以及Content-Type为application/x-www-form-urlencoded。对于其他方法的表单参数，Servlet容器是不会将其传播到那个map中的，所以<code>@RequestParam</code>也不会获取到。</p> <p>:::</p> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>对于POST或PUT等类型的普通表单请求，尽管其URL编码数据放在请求体中，也不能使用<code>@RequestBody</code>注解，否则会抛出警告，以及请求不能被处理：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Content</span> type <span class="token string">'application/x-www-form-urlencoded'</span> not supported
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <h3 id="文件上传"><a href="#文件上传" class="header-anchor">#</a> 文件上传</h3> <p>通过表单上传文件时，其Content-Type为multipart/form-data。在接收文件时变量的类型为<code>MultipartFile</code>，可以使用注解也可以不使用注解，而且既可以使用<code>@RequestParam</code>也可以使用<code>@RequestPart</code>。当使用<code>@RequestPart</code>注解时，对应的解析器为<code>RequestPartMethodArgumentResolver</code>；当使用<code>@RequestParam</code>或者不加注解，使用的是<code>RequestParamMethodArgumentResolver</code>解析器。注意，变量的参数名或者注解的value值都必须与Content-Disposition描述的name一致。如果用对象来接收的话不用添加任何注解即可接收。</p> <p>除此之外，还可以通过获取<code>MultipartHttpServletRequest</code>对象来手动调用<code>getFile()</code>或者是<code>getFiles()</code>方法来获取文件。</p> <p>当上传多个文件时，也可以使用上述方式，可以把所有文件的key都指定为一样的，然后通过数组来接收。如在postman中上传多个文件：</p> <p><img src="https://cdn.harrisonlee.net/image-20210119225006829.png" alt="image-20210119225006829"></p> <p>后端接收代码为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;upload&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello7</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>其实，get请求也能上传文件，不一定非得用post。</p> <div class="custom-block note"><p class="custom-block-title">笔记</p> <p>其实关于文件上传，上面说的两种解析器中使用了代理解析器来解析。在SpringMVC中真正解析文件的解析器有两个，<code>StandardServletMultipartResolver</code>和<code>CommonsMultipartResolver</code>。前者是Servlet 3.0的标准上传方式，SpringMVC默认会注入该解析器，使用该解析器必须要在web.xml配置<code>&lt;multipart-config&gt;</code>或者在JavaConfig中使用<code>@MultipartConfig</code>注解；后者会依赖apache的common-fileupload包，如果要使用后者，需要手动注入该bean，bean的名称必须为“multipartResolver”。具体细节后面再写一篇关于文件上传原理的文章吧。</p> <p>下面是在web.xml中配置<code>&lt;multipart-config&gt;</code>的实例：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>dispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>classpath:dispatcherServlet.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>load-on-startup</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>load-on-startup</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 配置在servelt标签中 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>multipart-config</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>dispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></div> <h2 id="请求头参数"><a href="#请求头参数" class="header-anchor">#</a> 请求头参数</h2> <p>请求头的值主要通过<code>@RequestHeader</code>注解的参数获取，参数处理器是<code>RequestHeaderMethodArgumentResolver</code>。注意，参数名或者是注解的value值必须和请求头的字段名称一致，如果没有这样名称的字段，那么会抛出警告并返回400的错误码。</p> <p>可以使用<code>@RequestHeader</code>修饰map类型参数，那么将会使用<code>RequestHeaderMapMethodArgumentResolver</code>解析器。</p> <h2 id="cookie值"><a href="#cookie值" class="header-anchor">#</a> Cookie值</h2> <p>Cookie值可以使用<code>@CookieValue</code>注解的参数获取，由<code>ServletCookieValueMethodArgumentResolver</code>处理器进行处理。同样地，参数名或者注解的value值必须和存在的cookie字段名称对应。</p> <h2 id="其他参数"><a href="#其他参数" class="header-anchor">#</a> 其他参数</h2> <p>对于其他类型的参数，如Model类型参数，或者<code>@ModelAttribute</code>参数请参考之前分析<a href="https://harrisonlee.net/pages/b2649d/" target="_blank" rel="noopener noreferrer">HandlerAdapter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的文章。</p> <h2 id="日期类型处理"><a href="#日期类型处理" class="header-anchor">#</a> 日期类型处理</h2> <p>日期类型的参数接收是很麻烦的，原因是通常是由字符串转换为日期对象，就涉及日期解析，由于日期格式多种多样，所以就需要我们根据期望的日期格式并提供相应的解析器。</p> <p>下面是几种对于接收日期类型的解决方案。</p> <ul><li><p>以字符串形式接收，然后手动转换。</p></li> <li><p>可以使用<code>@DateTimeFormat</code>注解，但是只能用表单类型的提交（x-www-form-urlencoded和form-data均可）。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@DateTimeFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">LocalDate</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;user2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">addUser2</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 可以接收到数据</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>使用<code>@JsonFormat</code>，没有<code>@DateTimeFormat</code>那种限制。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    
    <span class="token comment">/* 支持JSON格式，注意引入依赖：jackson-datatype-jsr310；否则报错 */</span>
    <span class="token annotation punctuation">@JsonFormat</span><span class="token punctuation">(</span>pattern <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">,</span> timezone <span class="token operator">=</span> <span class="token string">&quot;GMT+8&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">LocalDate</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;user2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">addUser2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>Jackson序列化和反序列化定制</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@JsonDeserialize</span><span class="token punctuation">(</span>using <span class="token operator">=</span> <span class="token class-name">CustomLocalDateDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token class-name">LocalDate</span> birthday<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 
根据需求选择LocalTimeDeserializer，LocalDateDeserializer还是LocalDateTimeDeserializer
*/</span>
<span class="token keyword">class</span> <span class="token class-name">CustomLocalDateDeserializer</span> <span class="token keyword">extends</span> <span class="token class-name">LocalDateDeserializer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">CustomLocalDateDeserializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>最佳实践</p> <p>直接修改<code>MappingJackson2HttpMessageConverter</code>中的<code>ObjectMapper</code>对于日期类型处理默认的序列化器和反序列化器，这样就可以对全局生效。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">Jackson2ObjectMapperBuilderCustomizer</span> <span class="token function">jackson2ObjectMapperBuilderCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> customizer<span class="token operator">-&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">/* 根据需求设置需要更改序列化逻辑的类型 */</span>
        customizer<span class="token punctuation">.</span><span class="token function">serializerByType</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">LocalDateTimeSerializer</span><span class="token punctuation">(</span>
            <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        customizer<span class="token punctuation">.</span><span class="token function">deserializerByType</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">LocalDateTimeDeserializer</span><span class="token punctuation">(</span>
            <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><p><a href="https://www.throwx.cn/2019/12/04/spring-mvc-param-handle-summary-1/" target="_blank" rel="noopener noreferrer">SpringMVC请求参数接收总结(一)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://blog.csdn.net/andy_zhang2007/article/details/100520572" target="_blank" rel="noopener noreferrer">SpringMVC文件上传原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=SpringMVC" title="标签">#SpringMVC</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021-01-21</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/b2649d/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">SpringMVC源码分析之HandlerAdapter</div></a> <a href="/pages/84c97b/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">SpringBoot自动配置原理</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/b2649d/" class="prev">SpringMVC源码分析之HandlerAdapter</a></span> <span class="next"><a href="/pages/84c97b/">SpringBoot自动配置原理</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/0c4c2e/"><div>Spring AOP基础</div></a> <span>02-08</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/e0358f/"><div>SpringBoot中Filter的注册</div></a> <span>02-07</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/226a87/"><div>Java中的Lambda表达式及原理</div></a> <span>01-29</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:lzipant@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/HarrisonLee1998" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2020-2021
    <span>Harrison Lee | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.36e91a11.js" defer></script><script src="/assets/js/2.409e0185.js" defer></script><script src="/assets/js/51.e28308a2.js" defer></script>
  </body>
</html>